# RAG （Retrieval-Augmented Generation）

## 검색, 증강, 생성

## 할루시네이션(hallucination)

## 언어모델의 성능향상을 위한 각 기술의 난이도 순서

- Prompt Engineering
- RAG : 난이도에 비해 성능 향상 비율이 높음 (압도적 성능)/ 할루시네이션 감소에 가장 큰 영향을 미침
- PEFT
- FULL FINE TUNING

## LangChain을 이용한 RAG 시스템 구축

- LangChain: 대규모 언어 모델로 구동되는 애플리케이션을 개발하기 위한 프레임워크. GPT와 같은 언어 모델과 우리가 만들고자 하는 서비스를 쉽게 연결해주는 도구
  c.f. GPT를 이용하여 고객 응대 챗봇 만들기 등 GPT의 두뇌를 원하는 작업 흐름에 접목하여 체인으로 엮는 형태
- ChatGPT: GPT라는 언어 모델을 기반으로 한 대화형 AI 플랫폼

![](https://images.contentstack.io/v3/assets/bltefdd0b53724fa2ce/blt1496b19e4c6f9e66/66ba412a46b3f4241b969f48/rag-in-action.jpeg)

## 리트리버(Retriever, 검색기)

: 해당 질문과 유사성이 높은 문서 찾아옴

다만, 정보에서 관련성 있는 정보만 리트리버에 전달하는 것이 필요 -> RAG 프로세스의 사전 단계

## 전처리 과정(사전단계) : 문서 로드- 텍스트 분할 - 임베딩- 저장

- 문서 로드 : 문서 로드 및 텍스트 분할
- 텍스트 분할 : 문서를 청크로 분할
  - 청크 오버랩: 청크 끝부분에서 맥락이 이어질 수 있도록 일부를 겹쳐서 분할
- 임베딩 : 청크를 컴퓨터가 이해할 수 있도록 임베딩
  - 임베딩이 비용이 들어가는 작업이기 때문에, 매번 할 수가 없어 DB에 저장
- 저장 : 임베딩된 청크를 DB에 저장

## 사전단계 이후의 실행 단계: 리트리버-프롬프트-LLM-체인생성

- 리트리버 : 질문이 주어지면, 이와 관련된 백터를 벡터 데이터베이스에서 검색함.
  - 사용자의 질문을 질문 벡터로 변환하고, 이 질문 벡터가 문서 벡터들과 비교되어 유사성이 계산됨. 이 과정에서 **코사인 유사도** 알고리즘 등 활용
  - 전체 시스템의 품질과 직결
- 프롬프트 : 검색된 정보를 바탕으로 언어 모델을 위한 질문을 구성함. 정보를 바탕으로 어떻게 질문할지를 결정하는 과정
- LLM : 구성된 프롬프트를 사용하여 언어 모델이 실제 답변을 생성함. 수집된 정보를 바탕으로 과제나 보고서를 작성하는 학생임.
- 체인생성 : 이전의 모든 과정을 하나의 파이프라인으로 묶어 주는 체인을 생성함
  - LCEL 문법 활용
